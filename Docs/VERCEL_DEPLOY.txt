# ğŸš€ DEPLOY FRONTEND LÃŠN VERCEL

## âœ… ÄÃƒ Cáº¤U HÃŒNH XONG

Frontend Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ há»— trá»£ deploy lÃªn Vercel vá»›i API Gateway tá»« Railway.

---

## ğŸ“‹ BÆ¯á»šC 1: Cáº¤U HÃŒNH BIáº¾N MÃ”I TRÆ¯á»œNG TRÃŠN RAILWAY

### **API Gateway Service**

VÃ o Railway Dashboard â†’ API Gateway Service â†’ Variables

ThÃªm biáº¿n:
```
ALLOWED_ORIGINS=https://your-app.vercel.app
```

**LÆ°u Ã½:** Thay `https://your-app.vercel.app` báº±ng domain thá»±c táº¿ cá»§a Vercel.

Náº¿u cÃ³ nhiá»u domain, cÃ¡ch nhau báº±ng dáº¥u pháº©y:
```
ALLOWED_ORIGINS=https://your-app.vercel.app,https://your-app-staging.vercel.app
```

**Sau Ä‘Ã³:** Redeploy API Gateway service

---

## ğŸ“‹ BÆ¯á»šC 2: DEPLOY LÃŠN VERCEL

### **CÃ¡ch 1: Deploy qua Vercel Dashboard**

1. VÃ o https://vercel.com/new
2. Import GitHub repository
3. Chá»n folder: `frontend/cnpm-fooddelivery`
4. Set **Environment Variables**:
   ```
   VITE_API_BASE_URL=https://api-gateway-service-production-04a1.up.railway.app/api
   VITE_MAPBOX_ACCESS_TOKEN=pk.eyJ1IjoibmdvdHVhbmFuaCIsImEiOiJjbWdtaTQ3dXYwdGh2Mm9wcWwxd3g3dGV1In0.7_DXCJmqmBNQQuXSF5w3Ow
   ```
5. Click **Deploy**

### **CÃ¡ch 2: Deploy qua Vercel CLI**

```bash
# CÃ i Vercel CLI
npm i -g vercel

# Di chuyá»ƒn vÃ o folder frontend
cd frontend/cnpm-fooddelivery

# Login Vercel
vercel login

# Deploy
vercel --prod

# Khi Ä‘Æ°á»£c há»i vá» env vars, nháº­p:
# VITE_API_BASE_URL: https://api-gateway-service-production-04a1.up.railway.app/api
# VITE_MAPBOX_ACCESS_TOKEN: pk.eyJ1IjoibmdvdHVhbmFuaCIsImEiOiJjbWdtaTQ3dXYwdGh2Mm9wcWwxd3g3dGV1In0.7_DXCJmqmBNQQuXSF5w3Ow
```

---

## ğŸ“‹ BÆ¯á»šC 3: Cáº¬P NHáº¬T ALLOWED_ORIGINS TRÃŠN RAILWAY

Sau khi deploy Vercel xong, báº¡n sáº½ cÃ³ domain nhÆ°: `https://cnpm-fooddelivery-xyz.vercel.app`

**Quay láº¡i Railway:**
1. VÃ o API Gateway Service â†’ Variables
2. Cáº­p nháº­t biáº¿n `ALLOWED_ORIGINS`:
   ```
   ALLOWED_ORIGINS=https://cnpm-fooddelivery-xyz.vercel.app
   ```
3. **Redeploy** API Gateway service

---

## ğŸ§ª KIá»‚M TRA

1. Má»Ÿ browser: `https://your-app.vercel.app`
2. Má»Ÿ DevTools Console, kiá»ƒm tra:
   ```
   ğŸ”§ API Configuration:
     - API_BASE_URL: https://api-gateway-service-production-04a1.up.railway.app/api
     - Mode: production
   ```
3. Má»Ÿ DevTools Network tab, kiá»ƒm tra:
   - Request URL: `https://api-gateway-service-production-04a1.up.railway.app/api/products`
   - Status: 200 OK
   - Response: cÃ³ dá»¯ liá»‡u products

---

## ğŸ”§ CÃCH HOáº T Äá»˜NG

### **Vercel:**
```
Frontend â†’ API Gateway (public URL) â†’ Backend Services
```

### **Railway/Docker:**
```
Frontend â†’ Nginx â†’ API Gateway (internal network) â†’ Backend Services
```

**Sá»± khÃ¡c biá»‡t:**
- **Vercel:** Frontend gá»i trá»±c tiáº¿p Ä‘áº¿n public URL cá»§a API Gateway
- **Railway:** Frontend gá»i `/api`, Nginx proxy sang API Gateway internal

**Code giá»‘ng nhau:**
- Frontend chá»‰ cáº§n biáº¿n `VITE_API_BASE_URL`
- Vercel: `VITE_API_BASE_URL=https://api-gateway...`
- Railway: `VITE_API_BASE_URL=/api`

---

## ğŸ“ TÃ“M Táº®T BIáº¾N MÃ”I TRÆ¯á»œNG

### **Vercel (frontend/cnpm-fooddelivery):**
```
VITE_API_BASE_URL=https://api-gateway-service-production-04a1.up.railway.app/api
VITE_MAPBOX_ACCESS_TOKEN=pk.eyJ1IjoibmdvdHVhbmFuaCIsImEiOiJjbWdtaTQ3dXYwdGh2Mm9wcWwxd3g3dGV1In0.7_DXCJmqmBNQQuXSF5w3Ow
```

### **Railway API Gateway:**
```
ALLOWED_ORIGINS=https://your-app.vercel.app
```

### **Railway Frontend (náº¿u váº«n dÃ¹ng):**
```
VITE_API_BASE_URL=/api
VITE_API_BASE_URL_INTERNAL=http://api-gateway.railway.internal:3000/api/
```

---

## ğŸš¨ TROUBLESHOOTING

### **Lá»—i CORS:**
```
Access to fetch at '...' has been blocked by CORS policy
```

**Giáº£i phÃ¡p:**
- Kiá»ƒm tra biáº¿n `ALLOWED_ORIGINS` trÃªn Railway Ä‘Ã£ Ä‘Ãºng domain Vercel chÆ°a
- Redeploy API Gateway service
- Clear cache browser

### **Lá»—i 404 Not Found khi gá»i API:**
```
GET https://api-gateway.../api/products 404
```

**Giáº£i phÃ¡p:**
- Kiá»ƒm tra `VITE_API_BASE_URL` cÃ³ Ä‘Ãºng khÃ´ng
- Kiá»ƒm tra API Gateway cÃ³ Ä‘ang cháº¡y khÃ´ng
- Test trá»±c tiáº¿p: `curl https://api-gateway.../api/products`

### **Vercel build failed:**
```
Type error: ...
```

**Giáº£i phÃ¡p:**
- Kiá»ƒm tra TypeScript errors
- Cháº¡y `npm run build` á»Ÿ local Ä‘á»ƒ test
- Fix lá»—i vÃ  push láº¡i

---

## ğŸ‰ HOÃ€N THÃ€NH

BÃ¢y giá» báº¡n Ä‘Ã£ cÃ³:
- âœ… Frontend deploy trÃªn Vercel (nhanh, free tier tá»‘t)
- âœ… Backend váº«n cháº¡y trÃªn Railway (private networking, database)
- âœ… CORS Ä‘Ã£ Ä‘Æ°á»£c config Ä‘Ãºng
- âœ… Code linh hoáº¡t cho cáº£ Vercel vÃ  Railway

**Lá»£i Ã­ch:**
- Vercel: CDN toÃ n cáº§u, deploy nhanh, preview URL cho má»—i commit
- Railway: Backend máº¡nh máº½, database, private networking
- TÃ¡ch biá»‡t frontend/backend â†’ dá»… scale

